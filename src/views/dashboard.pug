html
    head
        link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css")
        title= "Digitalskills API"
    body
        nav(class="navbar" role="navigation" aria-label="main navigation")
            .container
              .navbar-brand
                a(class="navbar-item" href="/")
                    p.is-size-4= "Digitalskills API"

                .navbar-menu
                    .navbar-start
                      a.navbar-item(href="/")= "Hem"

                      a.navbar-item(href="https://github.com/Assedon-AB/digspec-api" target="_blank")= "Dokumentation"

                      a.navbar-item(href="/api/v1/api-docs" target="_blank")= "Open API"


        section.section
            .container
                h1.title= "Begär ut en API-nyckel"

                .columns.is-desktop
                    if api_key
                        .column.is-half
                            p.mb-4= "Spara ner denna nyckel säkert någonstans, då du inte kommer kunna få ut denna nyckel igen."
                            .field
                                label(class="label")= "API Nyckel"
                                .control
                                    input(class="input" type="text" value=api_key readonly)
                    else
                        form(action="/api-nyckel" method="POST").column.is-half
                            .field
                                label(class="label")= "Domännamn"
                                .control
                                    input(class="input" type="text" name="host" value="" placeholder="Till exempel: google.com eller digitalskills.se" pattern="^((?!-)[A-Za-z0-9-]{1,}(?<!-)\.)+[A-Za-z]{2,}$" required)


                            button.button.is-info= "Begär API Nyckel"

        script(src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js")
        script(src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.min.js")
        script.
            $("form").submit((event) => {
                if ($("form").valid()) {
                    return true;
                } else {
                    alert("Ange ett korrekt domännamn. Till exempel: 'google.com' eller 'api.digitalskills.se'");
                    return false;
                }
            })
